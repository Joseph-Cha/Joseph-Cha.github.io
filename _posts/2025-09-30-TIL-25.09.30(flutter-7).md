---
title: "ğŸ“š Today I Learned 13íšŒì°¨ - Flutter ë™ì˜ìƒ í”Œë ˆì´ì–´ ğŸ¬"
date: 2025-09-30T00:00:00-00:00
categories:
  - TIL
  - Flutter
tags:
  - TIL
  - Flutter
  - VideoPlayer
---

# ğŸ“– Flutter ë™ì˜ìƒ í”Œë ˆì´ì–´

## ğŸ¯ í•™ìŠµ ëª©í‘œ

ë™ì˜ìƒ í”Œë ˆì´ì–´ ì•±ì„ êµ¬í˜„í•©ë‹ˆë‹¤. í•¸ë“œí°ì— ì €ì¥í•´ë‘” ë™ì˜ìƒì„ ì„ íƒí•˜ê³  ì‹¤í–‰í•˜ê³  ì»¨íŠ¸ë¡¤ í•˜ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

## ğŸ“š í•™ìŠµ ìˆœì„œ

### â­ ì‚¬ì „ ì§€ì‹
* í™”ë©´ íšŒì „
* ì‹œê°„ ë³€í™˜ ë° String íŒ¨ë”©

### ğŸ› ï¸ ì‚¬ì „ ì¤€ë¹„
* ê°€ìƒ ë‹¨ë§ì— ë™ì˜ìƒ ì¶”ê°€
* ì´ë¯¸ì§€ ì¶”ê°€
* pubspec.yaml
* ë„¤ì´í‹°ë¸Œ ì„¤ì •
* í”„ë¡œì íŠ¸ ì´ˆê¸°í™”

### ğŸ’» êµ¬í˜„í•˜ê¸°
* ì²« í™”ë©´
* ë°°ê²½ìƒ‰ ê·¸ë¼ë°ì´ì…˜
* íŒŒì¼ ì„ íƒ ê¸°ëŠ¥
* í”Œë ˆì´ í™”ë©´
* ë™ì˜ìƒ ì¬ìƒê¸°
* ë™ì˜ìƒ ì—°ë™
* ë™ì˜ìƒ ì»¨íŠ¸ë¡¤ ë²„íŠ¼
* ì»¨íŠ¸ë¡¤ëŸ¬ ê°ì¶”ê¸°
* íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€

## ğŸ“š ì£¼ìš” ë‚´ìš©

### â° ì‹œê°„ ë³€í™˜ ë° String íŒ¨ë”©

**Duration**ì˜ ê²½ìš° ê¸°ê°„ì„ í‘œì‹œí•´ ì£¼ëŠ” í´ë˜ìŠ¤ì¸ë°, `video_player` í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ë©´ì„œ í˜„ì¬ ì‹¤í–‰ë˜ê³  ìˆëŠ” ì˜ìƒì˜ ìœ„ì¹˜, ì˜ìƒì˜ ì´ ê¸¸ì´ ë“±ì„ `Duration` í´ë˜ìŠ¤ë¡œ ë°˜í™˜ ë°›ê²Œ ë©ë‹ˆë‹¤.
í•˜ì§€ë§Œ ì‹¤ì œ ì‚¬ìš©ìê°€ ì¢‹ì•„í•˜ëŠ” ë°ì´í„° íƒ€ì…ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ë³´ê¸° ì¢‹ì€ String ê°’ìœ¼ë¡œ ë°”ê¿”ì£¼ë©´ ì¢‹ìŠµë‹ˆë‹¤.

```dart
Duration duration = Duration(seconds: 192);
print(duration); // 0:03:12.000000
print(
  '${duration.inMinutes.toString().padLeft(2, '0')}:${(duration.inSeconds % 60).toString().padLeft(2, '0')}',
); // 03:12
```

* **inMinutes** ê²Œí„°ëŠ” ë¶„ ë‹¨ìœ„ ì‹œê°„ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
* **inSeconds** ê²Ÿí„°ëŠ” ì´ˆ ë‹¨ìœ„ ì‹œê°„ì„ ê°€ì ¸ì˜¤ëŠ” ì´ˆ ë‹¨ìœ„ ì‹œê°„ì€ ë¶„ì˜ ëª«ìœ¼ë¡œ ë„˜ì–´ê°„ ê°’ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ê°’ë§Œ ë³´ì—¬ì£¼ë©´ ë©ë‹ˆë‹¤.
* `String` í´ë˜ìŠ¤ì—ëŠ” `padLeft`ì™€ `padRight` í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ”ë° pad í•¨ìˆ˜ë“¤ì€ String ê¸¸ì´ë¥¼ ë§ì¶°ì£¼ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.
  * ìµœì†Œ ê¸¸ì´ë¥¼ ì…ë ¥í•˜ê³  ê¸¸ì´ê°€ ë¶€ì¡±í•œ ê²½ìš° ë‘ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì— ë“¤ì–´ê°„ ê°’ì„ ì±„ì›Œ ë„£ìŠµë‹ˆë‹¤.

> ğŸ’¡ **íŒ**: `padLeft(2, '0')`ë¥¼ ì‚¬ìš©í•˜ë©´ í•œ ìë¦¬ ìˆ«ìë¥¼ ë‘ ìë¦¬ë¡œ ë§ì¶° '03', '12'ì²˜ëŸ¼ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ¨ ë°°ê²½ìƒ‰ ê·¸ë¼ë°ì´ì…˜ êµ¬í˜„í•˜ê¸°

**BoxDecoration** í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ `Container` ìœ„ì ¯ì˜ ë°°ê²½ìƒ‰, í…Œë‘ë¦¬, ëª¨ì„œë¦¬ ë‘¥ê·¼ ì •ë„ ë“± ì „ë°˜ì ì¸ ë””ìì¸ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ¬ ë™ì˜ìƒ ì¬ìƒê¸° êµ¬í˜„í•˜ê¸°

* **AspectRatio**ëŠ” child ë§¤ê°œë³€ìˆ˜ì— ì…ë ¥ë˜ëŠ” ìœ„ì ¯ì˜ ë¹„ìœ¨ì„ ì •í•  ìˆ˜ ìˆëŠ” ìœ„ì ¯ì…ë‹ˆë‹¤.
* `aspectRatio` ë§¤ê°œë³€ìˆ˜ì— ì›í•˜ëŠ” ë¹„ìœ¨ì„ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ë¹„ìœ¨ì€ **ë„ˆë¹„/ë†’ì´**ë¡œ ì…ë ¥í•˜ë©´ ë˜ë©° 16:9 ë¹„ìœ¨ì„ ì…ë ¥í•˜ê³  ì‹¶ì„ ë•ŒëŠ” `16/9`ë¥¼ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.
* `VideoPlayerController`ë¥¼ ì„ ì–¸í•˜ë©´ ì…ë ¥ëœ ë™ì˜ìƒì˜ ë¹„ìœ¨ì„ `value.aspectRatio` ê²Œí„°ë¡œ ë°›ì•„ì˜¬ ìˆ˜ ìˆìœ¼ë‹ˆ ì§ì ‘ ë„£ì–´ì¤¬ìŠµë‹ˆë‹¤.

**VideoPlayerControllerì˜ ë„¤ì„ë“œ ìƒì„±ì**

| **ìƒì„±ì ì´ë¦„** | **ì„¤ëª…** |
|:---:|:---|
| `VideoPlayerController.asset` | ì•± ë‚´ë¶€ assetì—ì„œ ë™ì˜ìƒ ë¡œë“œ |
| `VideoPlayerController.network` | ë„¤íŠ¸ì›Œí¬ URLì—ì„œ ë™ì˜ìƒ ë¡œë“œ |
| `VideoPlayerController.file` | ë¡œì»¬ íŒŒì¼ì—ì„œ ë™ì˜ìƒ ë¡œë“œ |

### ğŸšï¸ Slider ìœ„ì ¯ ë™ì˜ìƒê³¼ ì—°ë™í•˜ê¸°

* **Stack** ìœ„ì ¯ì€ ê¸°ë³¸ì ìœ¼ë¡œ `children` ìœ„ì ¯ë“¤ì„ ì •ì¤‘ì•™ì— ìœ„ì¹˜ì‹œí‚µë‹ˆë‹¤.
* ë§Œì•½ Stack ë‚´ë¶€ì˜ íŠ¹ì • ìœ„ì¹˜ì— ìœ„ì ¯ì„ ìœ„ì¹˜ì‹œí‚¤ê³  ì‹¶ë‹¤ë©´ **Positioned** ìœ„ì ¯ì„ ì‚¬ìš©í•´ì„œ ìœ„ì¹˜ë¥¼ ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* `bottom: 0` â†’ Stackì˜ ê°€ì¥ ì•„ë˜ì— ìì‹ì„ ìœ„ì¹˜
* ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ ëê¹Œì§€ Slider ìœ„ì ¯ì´ ëŠ˜ì–´ë‚˜ê²Œ í•˜ë ¤ê³  `left`ì™€ `right` ë§¤ê°œë³€ìˆ˜ ëª¨ë‘ì— 0 ê°’ì„ ì£¼ë©´ ì™¼ìª½ë¶€í„° 0í”½ì…€ ê·¸ë¦¬ê³  ì˜¤ë¥¸ìª½ë¶€í„° 0í”½ì…€ê¹Œì§€ ìœ„ì¹˜ ì‹œí‚¤ë¼ëŠ” ì˜ë¯¸ê°€ ë˜ë¯€ë¡œ Slider ìœ„ì ¯ì„ ê°€ë¡œ ì „ì²´ë¡œ ëŠ˜ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **Slider** ìœ„ì ¯ì˜ `min` ê°’ì€ í•­ìƒ 0ì…ë‹ˆë‹¤ (0ì´ˆë¶€í„° ì‹œì‘ì„ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì—).
* ìµœëŒ“ê°’ì€ ë™ì˜ìƒì˜ ì¬ìƒ ê¸¸ì´ë¥¼ ì´ˆ ë‹¨ìœ„ë¡œ ë³€í™˜í•˜ë©´ ë©ë‹ˆë‹¤.

> ğŸ’¡ **ì£¼ìš” ë©”ì„œë“œ**
> * `videoPlayerController.seekTo()` í•¨ìˆ˜ëŠ” ë™ì˜ìƒì˜ ì¬ìƒ ìœ„ì¹˜ë¥¼ íŠ¹ì • ìœ„ì¹˜ë¡œ ì´ë™í•´ ì¤ë‹ˆë‹¤.
> * `videoPlayerController!.value.position.inSeconds` ê²Œí„°ë¥¼ ì‹¤í–‰í•˜ë©´ í˜„ì¬ ë™ì˜ìƒì´ ì‹¤í–‰ë˜ëŠ” ìœ„ì¹˜ ê°’ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ¤” Q) Playerì™€ Stateì˜ í•„ë“œì˜ ìœ„ì¹˜ê°€ ì„œë¡œ ë‹¤ë¥¸ ìƒíƒœì¸ë° ì™œ ì´ë ‡ê²Œ ë‚˜ëˆ ì„œ ì •ì˜ í•˜ëŠ” ê²Œ ì¢‹ì„ê¹Œ?

í”ŒëŸ¬í„°ì—ì„œ `StatefulWidget`ê³¼ `State` ê°ì²´ì˜ í•„ë“œë¥¼ ë‚˜ëˆ„ì–´ ì •ì˜í•˜ëŠ” ê²ƒì€ **ì„±ëŠ¥ ìµœì í™”**ì™€ **ë°ì´í„° ê´€ë¦¬ì˜ ëª…í™•ì„±** ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ëŠ” í”ŒëŸ¬í„° í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ì ì¸ ë™ì‘ ë°©ì‹ê³¼ ê¹Šì€ ê´€ë ¨ì´ ìˆìŠµë‹ˆë‹¤.

ê°„ë‹¨íˆ ìš”ì•½í•˜ë©´, **Widgetì€ 'ì„¤ì •(Configuration)'**ì´ê³  **StateëŠ” 'ìƒíƒœ(State)'** ê·¸ ìì²´ë¥¼ ì €ì¥í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

#### 1ï¸âƒ£ Widget: ë¶ˆë³€(Immutable)í•˜ëŠ” ì„¤ì • ê°’ ğŸ“œ

`CustomVideoPlayer` í´ë˜ìŠ¤ëŠ” `StatefulWidget`ì„ ìƒì†í•©ë‹ˆë‹¤. í”ŒëŸ¬í„°ì—ì„œ Widgetì€ UIì˜ **ì„¤ê³„ë„**ë‚˜ **ì„¤ì • ê°’**ìœ¼ë¡œ ì·¨ê¸‰ë˜ë©°, í•œ ë²ˆ ìƒì„±ë˜ë©´ ê·¸ ì•ˆì˜ ë‚´ìš©ì€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” **ë¶ˆë³€(immutable) ê°ì²´**ì…ë‹ˆë‹¤.

-   **`final XFile video;`**: ì´ ìœ„ì ¯ì´ ì–´ë–¤ ë¹„ë””ì˜¤ë¥¼ ì¬ìƒí•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ **ì„¤ì •**ì…ë‹ˆë‹¤. ë¶€ëª¨ ìœ„ì ¯ìœ¼ë¡œë¶€í„° ì „ë‹¬ë°›ìŠµë‹ˆë‹¤.
-   **`final GestureTapCallback onNewVideoPressed;`**: ë²„íŠ¼ì´ ëˆŒë ¸ì„ ë•Œ ì–´ë–¤ ë™ì‘ì„ í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ **ì„¤ì •**ì…ë‹ˆë‹¤.

í”ŒëŸ¬í„°ëŠ” í™”ë©´ì„ ë‹¤ì‹œ ê·¸ë¦´ ë•Œ(rebuild), ê¸°ì¡´ì˜ ìœ„ì ¯ì„ ìˆ˜ì •í•˜ëŠ” ëŒ€ì‹  **ìƒˆë¡œìš´ ìœ„ì ¯ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±**í•˜ì—¬ êµì²´í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë§Œì•½ `videoPlayerController`ì²˜ëŸ¼ ê³„ì†í•´ì„œ ë³€í•˜ëŠ” ìƒíƒœ ê°’ì´ ì´ 'ì„¤ì •' í´ë˜ìŠ¤ì— ìˆë‹¤ë©´, í™”ë©´ì´ ë‹¤ì‹œ ê·¸ë ¤ì§ˆ ë•Œë§ˆë‹¤ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìƒˆë¡œ ìƒì„±ë˜ë©´ì„œ ì´ì „ì˜ ì¬ìƒ ìƒíƒœ(ì¬ìƒ ìœ„ì¹˜, ë³¼ë¥¨ ë“±)ë¥¼ ëª¨ë‘ ìƒì–´ë²„ë¦¬ê²Œ ë©ë‹ˆë‹¤. ì´ëŠ” ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ê³  ì˜ë„ì¹˜ ì•Šì€ ë™ì‘ì„ ìœ ë°œí•©ë‹ˆë‹¤.

#### 2ï¸âƒ£ State: ê³„ì†í•´ì„œ ë³€í•˜ê³  ìœ ì§€ë˜ëŠ” ì‹¤ì œ ìƒíƒœ âš™ï¸

`_CustomVideoPlayerState` í´ë˜ìŠ¤ëŠ” `State`ë¥¼ ìƒì†í•©ë‹ˆë‹¤. ì´ ê°ì²´ëŠ” ìœ„ì ¯ íŠ¸ë¦¬ì—ì„œ í•œ ë²ˆ ìƒì„±ë˜ë©´ **ì‰½ê²Œ ì‚¬ë¼ì§€ì§€ ì•Šê³  ê³„ì† ìœ ì§€**ë©ë‹ˆë‹¤. ìœ„ì ¯(ì„¤ê³„ë„)ì´ ìƒˆë¡­ê²Œ êµì²´ë˜ë”ë¼ë„, í”ŒëŸ¬í„°ëŠ” ì´ `State` ê°ì²´ë¥¼ ì¬ì‚¬ìš©í•˜ì—¬ ìƒíƒœë¥¼ ë³´ì¡´í•©ë‹ˆë‹¤.

-   **`VideoPlayerController? videoPlayerController;`**: ë¹„ë””ì˜¤ì˜ ì¬ìƒ, ì •ì§€ ë“± ì‹¤ì œ ë¹„ë””ì˜¤ë¥¼ ì œì–´í•˜ê³  í˜„ì¬ ì¬ìƒ ìƒíƒœ(ìœ„ì¹˜, ë²„í¼ë§ ë“±)ë¥¼ ë‹´ê³  ìˆëŠ” **ì‹¤ì œ ìƒíƒœ** ê°ì²´ì…ë‹ˆë‹¤. ì´ ê°’ì€ ì‚¬ìš©ìì˜ ì¸í„°ë™ì…˜ì— ë”°ë¼ ê³„ì† ë³€í•´ì•¼ í•©ë‹ˆë‹¤.

`initState()`ì—ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì´ˆê¸°í™”í•˜ê³  `dispose()`ì—ì„œ í•´ì œí•˜ëŠ” ë“±, ì´ `State` ê°ì²´ëŠ” ìì‹ ë§Œì˜ **ìƒëª…ì£¼ê¸°(Lifecycle)**ë¥¼ ê°€ì§€ë©° ë‚´ë¶€ ë°ì´í„°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.

#### 3ï¸âƒ£ ê²°ë¡ : ì™œ ë‚˜ëˆ„ëŠ” ê²ƒì´ ì¢‹ì€ê°€? âœ…

ì´ëŸ¬í•œ ë¶„ë¦¬ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í•µì‹¬ì ì¸ ì¥ì ì„ ê°€ì§‘ë‹ˆë‹¤.

1. **ì„±ëŠ¥ ìµœì í™” (Performance)**: í™”ë©´ì´ ìì£¼ ë‹¤ì‹œ ê·¸ë ¤ì ¸ë„(`build` ë©”ì†Œë“œ í˜¸ì¶œ), `VideoPlayerController`ì²˜ëŸ¼ ë¬´ê±°ìš´ ê°ì²´ë‚˜ ë³µì¡í•œ ìƒíƒœ ê°’ë“¤ì€ ìƒˆë¡œ ìƒì„±ë˜ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤. **ë¶ˆí•„ìš”í•œ ì´ˆê¸°í™” ë¹„ìš©ì„ ë§‰ì•„** ì•± ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

2. **ìƒíƒœ ë³´ì¡´ (State Preservation)**: ë¶€ëª¨ ìœ„ì ¯ì˜ êµ¬ì¡° ë³€ê²½ ë“±ìœ¼ë¡œ ì¸í•´ `CustomVideoPlayer` ìœ„ì ¯ì´ ìƒˆë¡œ ìƒì„±ë˜ë”ë¼ë„, `_CustomVideoPlayerState` ê°ì²´ëŠ” ìœ ì§€ë˜ë¯€ë¡œ **ë¹„ë””ì˜¤ì˜ ì¬ìƒ ìœ„ì¹˜ë‚˜ ìƒíƒœê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ë³´ì¡´**ë©ë‹ˆë‹¤.

3. **ì½”ë“œì˜ ëª…í™•ì„± (Clarity)**: ìœ„ì ¯ì˜ **ì„¤ì •(Configuration)**ê³¼ ì‹¤ì œ **ë‚´ë¶€ ìƒíƒœ(State)**ê°€ ëª…í™•í•˜ê²Œ ë¶„ë¦¬ë˜ì–´ ì½”ë“œì˜ ì—­í• ì„ ì´í•´í•˜ê¸° ì‰½ê³  ìœ ì§€ë³´ìˆ˜ê°€ ìš©ì´í•´ì§‘ë‹ˆë‹¤.
   - `CustomVideoPlayer`: "ì´ ë¹„ë””ì˜¤ íŒŒì¼(`video`)ì„ ê°€ì§€ê³ , ì´ëŸ° ë™ì‘(`onNewVideoPressed`)ì„ í•˜ëŠ” í”Œë ˆì´ì–´ë¥¼ ë§Œë“¤ì–´ ì¤˜" ë¼ëŠ” **ìš”ì²­ì„œ**.
   - `_CustomVideoPlayerState`: ìš”ì²­ì„œì˜ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë¹„ë””ì˜¤ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ê³ , ì‹¤ì œë¡œ ì¬ìƒí•˜ê³ , í˜„ì¬ ì¬ìƒ ì‹œê°„ì„ ê¸°ì–µí•˜ëŠ” ë“± ëª¨ë“  **ì‹¤ì œ ì‘ì—…ê³¼ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ì£¼ì²´**.

### ğŸ”„ didUpdateWidgetì„ ì´ìš©í•œ ë™ì˜ìƒ ê°±ì‹ 

> âš ï¸ **ì£¼ì˜**: ìƒˆë¡œìš´ ë™ì˜ìƒì„ ì„ íƒí•´ë„ í™”ë©´ì—ëŠ” ìƒˆë¡œ ì„ íƒí•œ ì˜ìƒì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> * ê·¸ ì´ìœ ëŠ” ë™ì˜ìƒì˜ ì†ŒìŠ¤ë¥¼ `videoController` ë³€ìˆ˜ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™” í• ë•Œ ì„ ì–¸í–ˆëŠ”ë° í˜„ì¬ ì½”ë“œì—ì„œ `videoController` ë³€ìˆ˜ëŠ” `initState` í•¨ìˆ˜ì—ì„œë§Œ ì„ ì–¸ë˜ê¸° ë•Œë¬¸
> * **í•´ê²°ì±…**: `didUpdateWidget` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ìƒˆë¡œìš´ ë™ì˜ìƒì´ ì„ íƒë˜ì—ˆì„ ë•Œ `videoController`ë¥¼ ìƒˆë¡œ ìƒì„±í•˜ë„ë¡ ì½”ë“œë¥¼ ì¶”ê°€

**didUpdateWidgetì˜ ìƒëª…ì£¼ê¸°**
* `didUpdateWidget`ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ì˜ ìƒê°í•´ ë³´ë©´, ìœ„ì ¯ì€ ë§¤ê°œë³€ìˆ˜ì˜ ê°’ì´ ë³€ê²½ë  ë•Œ íê¸°ë˜ê³  ìƒˆë¡œ ìƒì„±ë©ë‹ˆë‹¤.
* ê·¸ë˜ì„œ `didUpdateWidget`ì˜ ì²«ë²ˆì§¸ ë§¤ê°œ ë³€ìˆ˜ì— ì…ë ¥ë˜ëŠ” `oldWidget`ì€ íê¸°ë˜ëŠ” ìœ„ì ¯ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

> ğŸ’¡ **covariant í‚¤ì›Œë“œ**: `CustomVideoPlayer` í´ë˜ìŠ¤ì˜ ìƒì†ëœ ê°’ë„ í—ˆê°€í•´ì¤ë‹ˆë‹¤.

## ğŸ’» ì‹¤ìŠµ ë° ì˜ˆì œ

### ğŸ“„ ì†ŒìŠ¤ ì½”ë“œ

```dart
import 'package:flutter/material.dart';
import 'package:vid_player/screen/home_screen.dart';

void main() {
  runApp(MaterialApp(home: HomeScreen()));
}

```

```dart
import 'package:flutter/material.dart';
import 'package:image_picker/image_picker.dart';
import 'package:vid_player/screen/custom_video_player.dart';

class HomeScreen extends StatefulWidget {
  const HomeScreen({super.key});

  @override
  State<HomeScreen> createState() => _HomeScreenState();
}

class _HomeScreenState extends State<HomeScreen> {
  XFile? video;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.black,
      body: video == null ? renderEmpty() : renderVideo(),
    );
  }

  Widget renderEmpty() {
    return Container(
      width: MediaQuery.of(context).size.width,
      decoration: getBoxDecoration(),
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          _Logo(onTap: onNewVideoPressed),
          SizedBox(height: 30.0),
          _AppName(),
        ],
      ),
    );
  }

  BoxDecoration getBoxDecoration() {
    return BoxDecoration(
      gradient: LinearGradient(
        begin: Alignment.topCenter,
        end: Alignment.bottomCenter,
        colors: [Color(0xFF2A3A7C), Color(0XFF000118)],
      ),
    );
  }

  Widget renderVideo() {
    return Center(
      child: CustomVideoPlayer(
        video: video!,
        onNewVideoPressed: onNewVideoPressed,
      ),
    );
  }

  void onNewVideoPressed() async {
    final video = await ImagePicker().pickVideo(source: ImageSource.gallery);

    if (video != null) {
      setState(() {
        this.video = video;
      });
    }
  }
}

class _Logo extends StatelessWidget {
  final GestureTapCallback onTap;

  const _Logo({required this.onTap});

  @override
  Widget build(BuildContext context) {
    return GestureDetector(
      onTap: onTap,
      child: Image.asset('asset/img/logo.png'),
    );
  }
}

class _AppName extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final textStyle = TextStyle(
      color: Colors.white,
      fontSize: 30.0,
      fontWeight: FontWeight.w300,
    );

    return Row(
      mainAxisAlignment: MainAxisAlignment.center,
      children: [
        Text('VEDIO', style: textStyle),
        Text('Player', style: textStyle.copyWith(fontWeight: FontWeight.w700)),
      ],
    );
  }
}

```

```dart
import 'dart:io';

import 'package:flutter/material.dart';
import 'package:image_picker/image_picker.dart';
import 'package:vid_player/component/custom_icon_button.dart';
import 'package:video_player/video_player.dart';

class CustomVideoPlayer extends StatefulWidget {
  final XFile video;
  final GestureTapCallback onNewVideoPressed;

  const CustomVideoPlayer({
    super.key,
    required this.video,
    required this.onNewVideoPressed,
  });

  @override
  State<CustomVideoPlayer> createState() => _CustomVideoPlayerState();
}

class _CustomVideoPlayerState extends State<CustomVideoPlayer> {
  VideoPlayerController? videoPlayerController;
  bool showControls = false;

  @override
  void initState() {
    super.initState();
    initializeController();
  }

  @override
  void dispose() {
    videoPlayerController?.removeListener(videoControllerListener);
    super.dispose();
  }

  @override
  void didUpdateWidget(covariant CustomVideoPlayer oldWidget) {
    super.didUpdateWidget(oldWidget);

    if (oldWidget.video.path != widget.video.path) {
      initializeController();
    }
  }

  initializeController() async {
    final videoController = VideoPlayerController.file(File(widget.video.path));

    await videoController.initialize();

    videoController.addListener(videoControllerListener);

    setState(() {
      // êµ³ì´ í• ë‹¹ì„ setState ë‚´ë¶€ì—ì„œ í•˜ëŠ” ì´ìœ : ì´ë ‡ê²Œ í•´ì•¼ buildë¥¼ ë‹¤ì‹œ í•˜ê²Œ ë˜ê³  ì›í•˜ëŠ” í™”ë©´ì„ ê·¸ë ¤ì£¼ê¸° ë•Œë¬¸ì—
      videoPlayerController = videoController;
    });
  }

  void videoControllerListener() {
    setState(() {});
  }

  @override
  Widget build(BuildContext context) {
    // ë™ì˜ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì¤€ë¹„ ì¤‘ì¼ ë•Œ
    // ìµœì´ˆë¡œ buildê°€ ë˜ëŠ”
    if (videoPlayerController == null) {
      return Center(child: CircularProgressIndicator());
    }
    return GestureDetector(
      onTap: () {
        setState(() {
          showControls = !showControls;
        });
      },
      child: AspectRatio(
        // ë™ì˜ìƒ ë¹„ìœ¨ì— ë”°ë¥¸ í™”ë©´ ë Œë”ë§
        aspectRatio: videoPlayerController!.value.aspectRatio,
        child: Stack(
          children: [
            VideoPlayer(videoPlayerController!),
            if (showControls) Container(color: Colors.black.withOpacity(0.5)),
            Positioned(
              bottom: 0,
              right: 0,
              left: 0,
              child: Padding(
                padding: EdgeInsets.symmetric(horizontal: 8.0),
                child: Row(
                  children: [
                    renderTimeTextFromDuration(
                      videoPlayerController!.value.position,
                    ),
                    Expanded(
                      child: Slider(
                        value: videoPlayerController!.value.position.inSeconds
                            .toDouble(),
                        min: 0,
                        max: videoPlayerController!.value.duration.inSeconds
                            .toDouble(),
                        onChanged: (double val) {
                          videoPlayerController!.seekTo(
                            Duration(seconds: val.toInt()),
                          );
                        },
                      ),
                    ),
                    renderTimeTextFromDuration(
                      videoPlayerController!.value.duration,
                    ),
                  ],
                ),
              ),
            ),
            if (showControls)
              Align(
                alignment: Alignment.topRight,
                child: CustomIconButton(
                  onPressed: widget.onNewVideoPressed,
                  iconData: Icons.photo_camera_back,
                ),
              ),
            if (showControls)
              Align(
                alignment: Alignment.center,
                child: Row(
                  mainAxisAlignment:
                      MainAxisAlignment.spaceEvenly, // ìì‹ ìœ„ì ¯ì˜ ê°„ê²©ì„ ë™ì¼í•˜ê²Œ ì„¤ì •
                  children: [
                    CustomIconButton(
                      onPressed: onReversePressed,
                      iconData: Icons.rotate_left,
                    ),
                    CustomIconButton(
                      onPressed: onPlayPressed,
                      iconData: videoPlayerController!.value.isPlaying
                          ? Icons.pause
                          : Icons.play_arrow,
                    ),
                    CustomIconButton(
                      onPressed: onForwardPressed,
                      iconData: Icons.rotate_right,
                    ),
                  ],
                ),
              ),
          ],
        ),
      ),
    );
  }

  Widget renderTimeTextFromDuration(Duration duration) {
    return Text(
      '${duration.inMinutes.toString().padLeft(2, '0')}: ${(duration.inSeconds % 60).toString().padLeft(2, '0')}',
      style: TextStyle(color: Colors.white),
    );
  }

  void onReversePressed() {
    final currentPosition = videoPlayerController!.value.position;

    Duration position = Duration();

    if (currentPosition.inSeconds > 3) {
      position = currentPosition - Duration(seconds: 3);
    }

    videoPlayerController!.seekTo(position);
  }

  void onForwardPressed() {
    final maxPosition = videoPlayerController!.value.duration;
    final currentPosition = videoPlayerController!.value.position;

    Duration position = maxPosition;
    if ((maxPosition - Duration(seconds: 3)).inSeconds >
        currentPosition.inSeconds) {
      position = currentPosition + Duration(seconds: 3);
    }

    videoPlayerController!.seekTo(position);
  }

  void onPlayPressed() {
    if (videoPlayerController!.value.isPlaying) {
      videoPlayerController!.pause();
    } else {
      videoPlayerController!.play();
    }
  }
}

```

```dart
import 'package:flutter/material.dart';

class CustomIconButton extends StatelessWidget {
  final GestureTapCallback onPressed;
  final IconData iconData;

  const CustomIconButton({
    super.key,
    required this.onPressed,
    required this.iconData,
  });

  @override
  Widget build(BuildContext context) {
    return IconButton(
      onPressed: onPressed,
      iconSize: 30.0,
      color: Colors.white,
      icon: Icon(iconData),
    );
  }
}

```

### ğŸ“± ì‹¤í–‰ í™”ë©´

<div align="center">
  <img src="../assets/images/TIL/2025-10-01-(1).png" width="500">
</div>

<div align="center">
  <img src="../assets/images/TIL/2025-10-01-(2).png" width="500">
</div>

<div align="center">
  <img src="../assets/images/TIL/2025-10-01-(3).png" width="500">
</div>

## ğŸ“ ë§ˆë¬´ë¦¬

### âœ… ì˜¤ëŠ˜ ë°°ìš´ ê²ƒ

- **Duration í´ë˜ìŠ¤**: ë™ì˜ìƒ ì¬ìƒ ì‹œê°„ì„ ì‚¬ìš©ì ì¹œí™”ì ì¸ í˜•íƒœë¡œ ë³€í™˜
- **VideoPlayerController**: ë™ì˜ìƒ ë¡œë“œ ë° ì¬ìƒ ì œì–´
- **AspectRatio**: ë™ì˜ìƒ ë¹„ìœ¨ì— ë§ì¶° í™”ë©´ ë Œë”ë§
- **Slider ìœ„ì ¯**: ë™ì˜ìƒ ì¬ìƒ ìœ„ì¹˜ í‘œì‹œ ë° ì œì–´
- **StatefulWidget vs State**: ì„¤ì •ê³¼ ìƒíƒœë¥¼ ë¶„ë¦¬í•˜ëŠ” ì´ìœ ì™€ ì¥ì 
- **didUpdateWidget**: ìœ„ì ¯ ë§¤ê°œë³€ìˆ˜ ë³€ê²½ ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸

### ğŸš€ ë‹¤ìŒ ê³„íš

- ì˜ìƒ í†µí™” ì•± êµ¬í˜„
- WebRTCì™€ ì•„ê³ ë¼ API í™œìš©